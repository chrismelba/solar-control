{% macro device_card(device, draggable=false) %}
<div class="device-card{% if draggable %} draggable{% endif %}" data-device-name="{{ device.name }}" {% if draggable %}draggable="true"{% endif %}>
    <div class="device-info">
        <p class="device-name">{{ device.name }}</p>
        <p class="device-power">
            <span class="device-power-value">{{ device.typical_power_draw }}W (assumed)</span>
        </p>
        {% if device.energy_consumption %}
        <p class="device-energy">
            Today: {{ (device.energy_consumption.today )|round(2) }} kWh
        </p>
        {% endif %}
        <p class="device-power-delivered">
            Energy Delivered: {{ device.energy_delivered_today|round(2) }} kWh
        </p>
    </div>
    {% if not draggable %}
    <div class="device-actions">
        <button class="edit-device button" data-device-name="{{ device.name }}">Edit</button>
        <button class="delete-device button" data-device-name="{{ device.name }}">Delete</button>
    </div>
    {% else %}
    {% if device.energy_sensor %}
    <div class="one-off-charge-section" data-device-name="{{ device.name }}">
        <div class="one-off-charge-status" style="display:none"></div>
        <button class="one-off-charge-btn" data-device-name="{{ device.name }}">⚡ Charge</button>
        <div class="one-off-charge-input-row" style="display:none">
            <input type="number" class="one-off-charge-input" min="0.1" step="0.1" placeholder="kWh">
            <button class="one-off-charge-submit">Go</button>
            <button class="one-off-charge-cancel-input">✕</button>
        </div>
    </div>
    {% endif %}
    <label class="switch">
        <input type="checkbox" class="device-toggle" data-device-name="{{ device.name }}">
        <span class="slider round"></span>
    </label>
    {% endif %}
</div>
{% endmacro %}
